# إعداد Google Sheets للنظام

## الخطوات المطلوبة:

### 1. إنشاء Google Spreadsheet جديد
- انتقل إلى [Google Sheets](https://sheets.google.com)
- أنشئ جدول بيانات جديد
- انسخ معرف الجدول من الرابط (الجزء بين `/d/` و `/edit`)

### 2. إعداد الأوراق المطلوبة
أنشئ الأوراق التالية في الجدول:

#### ورقة "العقود"
العمود A: معرف العقد
العمود B: اسم العقد  
العمود C: رقم العقد
العمود D: تاريخ البداية
العمود E: تاريخ النهاية
العمود F: القيمة الإجمالية للإيجار
العمود G: رسوم خدمات المرافق
العمود H: رسوم اللوحات
العمود I: فترة السداد
العمود J: حالة العقد
العمود K: ملاحظات
العمود L: تاريخ الإنشاء
العمود M: تاريخ التحديث
العمود N: منشئ العقد

#### ورقة "الدفعات"
العمود A: معرف الدفعة
العمود B: معرف العقد
العمود C: نوع الدفعة
العمود D: المبلغ
العمود E: تاريخ الدفع
العمود F: تاريخ الاستحقاق
العمود G: حالة الدفعة
العمود H: طريقة الدفع
العمود I: رقم الإيصال
العمود J: ملاحظات
العمود K: منشئ الدفعة
العمود L: تاريخ الإنشاء
العمود M: تاريخ التحديث

#### ورقة "المستخدمين"
العمود A: معرف المستخدم
العمود B: اسم المستخدم
العمود C: الاسم الكامل
العمود D: البريد الإلكتروني
العمود E: الدور
العمود F: الصلاحيات (مفصولة بفواصل)
العمود G: الحالة
العمود H: آخر دخول
العمود I: تاريخ الإنشاء

### 3. الحصول على Google API Key
- انتقل إلى [Google Cloud Console](https://console.cloud.google.com)
- أنشئ مشروع جديد أو اختر مشروع موجود
- فعّل Google Sheets API
- أنشئ API Key
- قيّد الـ API Key للاستخدام مع Google Sheets API فقط

### 4. إعداد الصلاحيات
- اجعل الجدول قابل للقراءة من قبل أي شخص لديه الرابط
- أو أضف عنوان البريد الإلكتروني للخدمة كمحرر

### 5. تحديث ملف البيئة
\`\`\`env
NEXT_PUBLIC_GOOGLE_SHEETS_ID=معرف_الجدول_هنا
NEXT_PUBLIC_GOOGLE_API_KEY=مفتاح_API_هنا
\`\`\`

## ملاحظات مهمة:

### للقراءة فقط:
- يمكن استخدام Google Sheets API مع API Key للقراءة فقط
- هذا مناسب للعرض والاستعلام

### للكتابة والتحديث:
- تحتاج إلى استخدام OAuth 2.0
- أو استخدام Service Account
- يتطلب مصادقة أكثر تعقيداً

### البدائل للكتابة:
1. **Google Apps Script**: إنشاء Web App يتعامل مع الكتابة
2. **Service Account**: للتطبيقات الخادمية
3. **OAuth 2.0**: للتطبيقات التفاعلية

## مثال على إعداد Service Account:

\`\`\`javascript
// للاستخدام في بيئة الخادم
import { GoogleAuth } from 'google-auth-library'
import { sheets } from 'googleapis'

const auth = new GoogleAuth({
  keyFile: 'path/to/service-account-key.json',
  scopes: ['https://www.googleapis.com/auth/spreadsheets']
})

const sheetsAPI = sheets({ version: 'v4', auth })
\`\`\`

## الأمان:
- لا تضع API Keys في الكود المصدري
- استخدم متغيرات البيئة
- قيّد استخدام API Keys للنطاقات المطلوبة فقط
- راقب استخدام API للتأكد من عدم تجاوز الحدود
